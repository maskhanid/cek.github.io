<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>MasKhan Convert — Premium</title>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <!-- Tailwind (optional) -->
  <script src="https://cdn.tailwindcss.com" defer></script>

  <!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" defer></script>

  <!-- Main stylesheet -->
  <link rel="stylesheet" href="assets/css/style.css" />
</head>
<body class="premium-bg text-white">

  <!-- Ambient decorative background (subtle animated gradient + noise) -->
  <div class="ambient-bg" aria-hidden="true"></div>

  <main class="container">
    <header class="topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="none" aria-hidden="true"><defs><linearGradient id="g1" x1="0" x2="1"><stop offset="0" stop-color="#6c5ce7"/><stop offset="1" stop-color="#4e9af1"/></linearGradient></defs><rect width="24" height="24" rx="6" fill="url(#g1)"></rect><path d="M7 12h10M7 8h6M7 16h10" stroke="#fff" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </div>
        <div class="brand-text">
          <div class="title">MasKhan Convert</div>
          <div class="subtitle">Crypto • Pulsa • E-Wallet — Premium UI</div>
        </div>
      </div>

      <div class="controls">
        <button id="openHistory" class="icon-btn" title="Riwayat">Riwayat</button>
      </div>
    </header>

    <section class="panel">
      <div class="panel-left">

        <!-- Mode select -->
        <div class="field">
          <label class="label">Mode</label>
          <select id="modeSelect" class="select" aria-label="Pilih mode transaksi">
            <option value="crypto">Crypto</option>
            <option value="pulsa">Pulsa</option>
            <option value="ewallet">E-Wallet</option>
          </select>
        </div>

        <!-- CRYPTO block -->
        <div id="cryptoSection" class="card card-glass">
          <h3 class="card-title">Crypto</h3>

          <div class="field">
            <label class="label">Tujuan</label>
            <select id="cryptoExchange" class="select" aria-label="Pilih exchange atau on-chain">
              <option value="">Pilih Tujuan</option>
              <option>Binance</option>
              <option>Bybit</option>
              <option>Wallet Crypto / Onchain</option>
            </select>
          </div>

          <!-- network moved BELOW exchange for better mobile layout -->
          <div id="chainWrap" class="field hidden mt-2">
            <label class="label">Network (On-chain)</label>
            <select id="chainSelect" class="select small" aria-label="Pilih network">
              <option value="">- Pilih Network -</option>
              <option value="bsc">BSC (BEP20)</option>
              <option value="eth">ETH (ERC20)</option>
              <option value="matic">MATIC (Polygon)</option>
              <option value="plasma">PLASMA</option>
              <option value="arbitrum">ARBITRUM</option>
              <option value="avaxc">AVAXC</option>
              <option value="optimism">OPTIMISM</option>
              <option value="opbnb">OPBNB</option>
              <option value="tron">TRON (TRC20)</option>
              <option value="aptos">Aptos</option>
              <option value="solana">Solana</option>
              <option value="ton">Ton</option>
              <option value="near">Near</option>
              <option value="tezos">Tezos</option>
            </select>
          </div>

          <div class="field mt-3">
            <label class="label">Nominal (USD)</label>
            <div class="row">
              <select id="usdSelect" class="select" aria-label="Pilih nominal USD">
                <!-- opsi diisi oleh JS -->
              </select>
              <button id="cryptoMax" class="btn-outline" title="Max">MAX</button>
            </div>
          </div>

          <div id="usdCustomWrap" class="field hidden mt-2">
            <input id="usdCustomInput" type="number" class="input" placeholder="Masukkan USD — contoh: 12.5" />
          </div>

          <div class="row mt-4 gap-2">
            <button id="calcCryptoBtn" class="btn btn-primary btn-lg flex-1">Hitung</button>
            <button id="clearCryptoBtn" class="btn btn-ghost">Reset</button>
          </div>

          <!-- info area (exchange id / onchain address + copy) -->
          <div id="infoArea" class="mt-3 hidden" aria-live="polite"></div>
        </div>

        <!-- Pulsa -->
        <div id="pulsaSection" class="card card-glass hidden mt-4">
          <h3 class="card-title">Pulsa</h3>

          <div class="field">
            <label class="label">Operator</label>
            <select id="pulsaOperator" class="select">
              <option value="">Pilih Operator</option>
              <option value="axis" data-rate="85">AXIS — rate 85%</option>
              <option value="indosat" data-rate="80">INDOSAT — rate 80%</option>
            </select>
          </div>

          <div class="row mt-3">
            <div class="field flex-1">
              <label class="label">Nominal (Rp)</label>
              <input id="pulsaAmount" class="input" type="number" placeholder="Contoh: 150000" />
            </div>
            <div class="field ml-3 flex-1">
              <label class="label">Nomor Tujuan (opsional)</label>
              <input id="pulsaTargetManual" class="input" type="text" placeholder="08xxxxxxxxxx (jika ingin override)" />
            </div>
          </div>

          <div id="pulsaTargetWrap" class="mt-3 hidden" aria-live="polite">
            <div class="text-xs muted">Nomor tujuan (otomatis)</div>
            <div class="addr-box flex items-center justify-between mt-2">
              <div id="pulsaTargetText" class="addr-text">-</div>
              <button id="copyPulsaTarget" class="copy-icon" aria-label="Salin nomor tujuan">
                <svg viewBox="0 0 24 24" fill="none"><path d="M16 4H8a2 2 0 0 0-2 2v10" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><rect x="9" y="8" width="10" height="12" rx="2" stroke="currentColor" stroke-width="1.6"/></svg>
              </button>
            </div>
          </div>

          <div class="row mt-4">
            <button id="confirmPulsa" class="btn btn-primary btn-lg flex-1">Konfirmasi Pulsa</button>
            <button id="clearPulsaBtn" class="btn btn-ghost">Reset</button>
          </div>
        </div>

        <!-- E-Wallet -->
        <div id="ewalletSection" class="card card-glass hidden mt-4">
          <h3 class="card-title">E-Wallet</h3>

          <div class="row">
            <div class="field flex-1">
              <label class="label">Nominal (Rp)</label>
              <input id="ewalletAmount" class="input" type="number" placeholder="Contoh: 75000" />
            </div>
            <div class="field ml-3 flex-1">
              <label class="label">Tujuan (No / ID)</label>
              <input id="ewalletTarget" class="input" type="text" placeholder="No HP atau ID tujuan" />
            </div>
          </div>

          <div id="ewalletResultImg" class="hidden text-center mt-3">
            <img id="ewalletQrImg" class="w-44 h-44 object-contain rounded-lg mx-auto bg-white p-2" alt="QRIS Image" src="" />
            <div class="text-xs muted mt-2">QRIS — Scan untuk bayar</div>
          </div>

          <div class="row mt-4">
            <button id="confirmEwallet" class="btn btn-primary btn-lg flex-1">Konfirmasi E-Wallet</button>
            <button id="clearEwalletBtn" class="btn btn-ghost">Reset</button>
          </div>
        </div>

      </div>

      <!-- right column: preview + notes -->
      <aside class="panel-right">
        <div class="card card-glass sticky">
          <div class="preview-hero">
            <div class="preview-title">Preview & Summary</div>
            <div class="preview-sub">Harga akan dikunci pada saat preview</div>
          </div>

          <div id="previewCard" class="result-card hidden" role="status" aria-live="polite">
            <div class="flex justify-between items-center">
              <div>
                <div class="text-xs muted">Invoice</div>
                <div id="previewInvoice" class="font-semibold">-</div>
              </div>
              <div class="text-right">
                <div class="text-xs muted">Sisa waktu</div>
                <div id="previewRemaining" class="text-sm opacity-80">-</div>
              </div>
            </div>

            <div class="mt-3 space-y-1">
              <div class="flex justify-between"><div class="muted small">Rate</div><div id="previewRate">-</div></div>
              <div class="flex justify-between"><div class="muted small">Gross</div><div id="previewGross">-</div></div>
              <div class="flex justify-between"><div class="muted small">Fee</div><div id="previewFee">-</div></div>
              <div class="flex justify-between"><div class="muted small"><strong>Total Bayar</strong></div><div id="previewNet"><strong>-</strong></div></div>
            </div>

            <div class="mt-4 flex gap-2">
              <button id="confirmPreviewBtn" class="btn btn-primary flex-1">Konfirmasi via WA</button>
              <button id="cancelPreviewBtn" class="btn btn-ghost flex-1">Batal</button>
            </div>
            <div id="previewNote" class="mt-2 text-xs opacity-70">Harga dikunci. Tekan Batal untuk ubah.</div>
          </div>

          <div class="hint mt-4 muted small">
            <div>Tip: Klik <strong>Hitung</strong> untuk melihat estimasi pembayaran. Preview akan dikunci selama 10 menit.</div>
          </div>
        </div>
      </aside>
    </section>

    <footer class="foot">
      <div class="muted small">© MasKhan — tampil premium oleh asisten</div>
    </footer>
  </main>

  <!-- history overlay (fullscreen, opaque) -->
  <div id="historyOverlay" class="history-overlay hidden" aria-hidden="true" role="dialog" aria-modal="true" tabindex="-1">
    <div class="overlay-card">
      <div class="overlay-head">
        <h4>Riwayat Transaksi</h4>
        <div style="display:flex;gap:8px;">
          <button id="clearHistory" class="btn-ghost">Hapus semua</button>
          <button id="closeHistory" class="btn-ghost">Tutup</button>
        </div>
      </div>
      <div id="historyList" class="history-list"></div>
      <div id="noHistory" class="muted-xs text-center mt-6">Belum ada riwayat transaksi.</div>
    </div>
  </div>

  <script src="assets/js/app.js"></script>
</body>
</html>
